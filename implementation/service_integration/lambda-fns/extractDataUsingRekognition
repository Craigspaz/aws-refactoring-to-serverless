const aws = require('aws-sdk');
const rekognition = new aws.Rekognition();

exports.handler = async (event,context, callback) => {
	console.log(event)

	const bucket = event.s3Bucket;
	const imageName = event.imageName;

	var params = {
		Image: {
			S3Object: {
				Bucket: bucket,
				Name: imageName
			}
		},
		MaxLabels: 5,
		MinConfidence: 80
	};

	try {
		const result = await rekognition.detectLabels(params).promise();
		callback(null, result.Labels);
	} catch (err) {
		callback(err);
	}

}